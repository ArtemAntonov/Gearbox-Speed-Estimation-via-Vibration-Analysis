# Gearbox Speed Estimation via Vibration Analysis
This repository implements a machine-learning model for estimation of shaft rotational speed by analyzing two-axis accelerometer vibration measurements. Raw vibration data is converted to the frequency domain via Fast Fourier Transform(FFT) and subsequently processed by a PyTorch convolutional neural network(CNN), achieving a mean absolute error(MAE) of 1.17 on hold-out data. By eliminating the need for dedicated tachometers, this tachometer-less solution delivers cost-effective, non-intrusive speed monitoring for legacy industrial machinery.

### Objective
Develop a neural network that predicts rotational speed by analyzing raw vibration signals.

### Data
[Mechanical Gear Vibration Dataset](https://www.kaggle.com/datasets/hieudaotrung/gear-vibration/data) was used for this project. It contains 36 time serieses(runs), representing shaft vibration readings along two axis for six different gear faults under two loads and at three speeds.
<details>
<summary>columns description</summary>

- sensor1 - displacement along x-axis(mm)
- sensor2 - displacement along y-axis(mm)
- time_x - sampling timestamp
- speedSet - speed(revolutions per second)
- load_value - load(Nm)
- gear_fault_desc - gear fault type
</details>

### Key Features
- **EDA**: Great Expectations, Autocorrelation, MSTL, FFT.
- **Data Preparation**: FFT, Custom Oversampling.
- **Model Development**: PyTorch, MLflow, Early Stopping, Learning Rate Scheduling, CNN.

### Project Flow
1. [Exploratory Data Analysis](https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/#1-exploratory-data-analysis)
2. [Data Preparation](https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/#2-data-preparation)
3. [Model training](https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/#3-model-training)
4. [Conclusion](https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/#4-conclusion)

### 1. Exploratory Data Analysis
The dataset has data as per description, without missed values. Each gearbox run has 25000 samples and was performed in different time, resulting in non-overlapping readings time that can be used as index in time series. The dataset provides axial and radial shaft vibration readings.<br/>
The readings exhibit a visible trend, possibly due to the gearbox not being fully warmed up before measurements. The data shows multiple seasonal patterns with non linear behavior, which together with hight noise levels suggest multiple resonting components in the system. Each gear fault produces a unique vibration signature.<br/>
Frequency-domain plots provide the clearest differentiation between runs.
<p align="center">
<img src="https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/blob/main/img/1.png"/>
</p>

### 2. Data Preparation
The dataset is relatively small compared to complexity of the system. Thus, the primary data preparation challenge was maximizing the number of usable samples.<br/>
As EDA showed, the most informative representation was the 0â€“50 Hz band of the FFT, which became the basis for feature extraction. The minimal number of sensor readings needed to form a recognizable spectrum was determined to be 12500. Then, a moving window method with a step of 100 samples was applied to each run to create multiple spectrums.
<p align="center">
<img src="https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/blob/main/img/2.png"/>
</p>
Since the number of spectrums was still insufficient for model training, synthetic augmentation was applied. Synthetic spectrums were generated by shifting values in the FFT array and filling gaps with noise, significantly increasing the available training data.
<p align="center">
<img src="https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/blob/main/img/3.png"/>
</p>

### 3. Model training
The data was split into three sets:
- Train(synthetic data)
- Test(real data, excluding validation samples)
- Validation(real unseen data)
The Mean Squared Error (MSE) metric was chosen for training, being highly sensitive to large errors. Training was performed in three phases:
- Architecture search
- Layer configuration tuning
- Weight decay selection and final training
All experiments and models were tracked with MLflow.<br/>
Champion model architecture:

```
nn.Conv2d(1, 33, kernel_size=(2, 15), padding=(0, 7)),                     
nn.ReLU(),
nn.Conv2d(33, 1, kernel_size=(1, 1)), 
nn.Linear(115, 40),   
nn.ReLU(),
nn.Linear(40, 1)
```
The best model achieved MSE 4.8862 and MAE 1.1665 on validation set.
<p align="center">
<img src="https://github.com/ArtemAntonov/Gearbox-Speed-Estimation-via-Vibration-Analysis/blob/main/img/4.png"/>
</p>

### 4. Conclusion
The best performing model reached MSE 4.8862 and MAE 1.1665, corresponding to 3.65% of the prediction range. All trained models and training process loss values were logged with MLflow, enabling future reproducibility and model comparisons.<br/>
During architecture selection and training, the trained models demonstrated high sensitivity to batch size. Best result, that was achieved with batch size 20(5 more, than used in final experiments series) was MSE ~16, when best result of 100 batch size was MSE ~49. This can be explained by low data diversity, specifically peaks configurations.